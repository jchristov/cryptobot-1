const candles = require('./candles')
const { withIndicators } = require('../helpers')

jest.mock('../config', () => ({
  indicators: {
    ema: 30,
    sma: 10,
    vol: 20
  }
}))

test('withIndicators', () => {
  const candlesWithIndicators = withIndicators(candles)
  expect(JSON.stringify(candlesWithIndicators)).toBe('[{"time":1526490180000,"open":8254.99,"high":8264.58,"low":8254.99,"close":8264.58,"volume":4.882817,"trades":65,"volumePerTrade":0.07512026153846155,"indicators":{"ema":false,"sma":false,"vol":false}},{"time":1526490240000,"open":8261.93,"high":8261.93,"low":8255,"close":8256.02,"volume":5.668264,"trades":90,"volumePerTrade":0.06298071111111112,"indicators":{"ema":false,"sma":false,"vol":false}},{"time":1526490300000,"open":8256.01,"high":8258.85,"low":8241.13,"close":8241.13,"volume":14.565163,"trades":113,"volumePerTrade":0.12889524778761063,"indicators":{"ema":false,"sma":false,"vol":false}},{"time":1526490360000,"open":8241.14,"high":8244,"low":8222,"close":8239.94,"volume":8.775009,"trades":795,"volumePerTrade":0.011037747169811322,"indicators":{"ema":false,"sma":false,"vol":false}},{"time":1526490420000,"open":8239.94,"high":8239.94,"low":8232.12,"close":8238.99,"volume":11.233093,"trades":389,"volumePerTrade":0.028876845758354756,"indicators":{"ema":false,"sma":false,"vol":false}},{"time":1526490480000,"open":8238.99,"high":8239,"low":8234.23,"close":8239,"volume":7.367577,"trades":130,"volumePerTrade":0.056673669230769226,"indicators":{"ema":false,"sma":false,"vol":false}},{"time":1526490540000,"open":8238,"high":8240,"low":8235,"close":8239.03,"volume":8.842339,"trades":86,"volumePerTrade":0.10281789534883722,"indicators":{"ema":false,"sma":false,"vol":false}},{"time":1526490600000,"open":8239.03,"high":8240,"low":8239.01,"close":8240,"volume":11.528842,"trades":98,"volumePerTrade":0.11764124489795917,"indicators":{"ema":false,"sma":false,"vol":false}},{"time":1526490660000,"open":8239.99,"high":8245.51,"low":8239.01,"close":8239.01,"volume":12.992179,"trades":112,"volumePerTrade":0.11600159821428571,"indicators":{"ema":false,"sma":false,"vol":false}},{"time":1526490720000,"open":8239.01,"high":8239.02,"low":8229.04,"close":8234.21,"volume":13.301124,"trades":153,"volumePerTrade":0.08693545098039215,"indicators":{"ema":false,"sma":8243.191,"vol":false}},{"time":1526490780000,"open":8234.21,"high":8235.4,"low":8225.04,"close":8228.24,"volume":15.104534,"trades":505,"volumePerTrade":0.02990996831683168,"indicators":{"ema":false,"sma":8239.556999999999,"vol":false}},{"time":1526490840000,"open":8228.24,"high":8238.67,"low":8225.89,"close":8234.19,"volume":3.021278,"trades":176,"volumePerTrade":0.017166352272727274,"indicators":{"ema":false,"sma":8237.374,"vol":false}},{"time":1526490900000,"open":8235.92,"high":8237.64,"low":8234.2,"close":8234.21,"volume":8.891426,"trades":59,"volumePerTrade":0.15070213559322032,"indicators":{"ema":false,"sma":8236.682,"vol":false}},{"time":1526490960000,"open":8234.22,"high":8236.88,"low":8228.67,"close":8228.68,"volume":9.690584,"trades":57,"volumePerTrade":0.17001024561403508,"indicators":{"ema":false,"sma":8235.556,"vol":false}},{"time":1526491020000,"open":8228.67,"high":8236.62,"low":8223.7,"close":8225.52,"volume":22.195539,"trades":283,"volumePerTrade":0.07842946643109541,"indicators":{"ema":false,"sma":8234.209,"vol":false}},{"time":1526491080000,"open":8225.52,"high":8235.86,"low":8225.52,"close":8229,"volume":7.34622,"trades":165,"volumePerTrade":0.044522545454545454,"indicators":{"ema":false,"sma":8233.209,"vol":false}},{"time":1526491140000,"open":8228.33,"high":8320,"low":8227.66,"close":8310.02,"volume":122.437825,"trades":672,"volumePerTrade":0.1821991443452381,"indicators":{"ema":false,"sma":8240.308,"vol":false}},{"time":1526491200000,"open":8314.98,"high":8332.45,"low":8265.91,"close":8280.95,"volume":170.540291,"trades":1218,"volumePerTrade":0.1400166592775041,"indicators":{"ema":false,"sma":8244.403,"vol":false}},{"time":1526491260000,"open":8280.95,"high":8291.54,"low":8270.95,"close":8271.15,"volume":13.757349,"trades":1039,"volumePerTrade":0.01324095187680462,"indicators":{"ema":false,"sma":8247.617,"vol":false}},{"time":1526491320000,"open":8271.16,"high":8323.92,"low":8271.16,"close":8276.5,"volume":104.613952,"trades":910,"volumePerTrade":0.11496038681318681,"indicators":{"ema":false,"sma":8251.846,"vol":28.83777025}},{"time":1526491380000,"open":8276.5,"high":8300.74,"low":8265.93,"close":8265.93,"volume":91.456717,"trades":1133,"volumePerTrade":0.08072084466019418,"indicators":{"ema":false,"sma":8255.615,"vol":33.16646525}},{"time":1526491440000,"open":8267.19,"high":8296.77,"low":8258.37,"close":8273.83,"volume":28.669121,"trades":461,"volumePerTrade":0.06218898264642082,"indicators":{"ema":false,"sma":8259.579,"vol":34.31650810000001}},{"time":1526491500000,"open":8273.95,"high":8296.97,"low":8273.91,"close":8290.77,"volume":7.451154,"trades":105,"volumePerTrade":0.07096337142857143,"indicators":{"ema":false,"sma":8265.235,"vol":33.96080765000001}},{"time":1526491560000,"open":8290.76,"high":8290.77,"low":8283.24,"close":8290.22,"volume":5.995292,"trades":124,"volumePerTrade":0.04834912903225806,"indicators":{"ema":false,"sma":8271.389000000001,"vol":33.821821799999995}},{"time":1526491620000,"open":8289.78,"high":8290.5,"low":8284.42,"close":8290.5,"volume":5.07962,"trades":86,"volumePerTrade":0.059065348837209306,"indicators":{"ema":false,"sma":8277.887,"vol":33.51414815}},{"time":1526491680000,"open":8286.06,"high":8290.5,"low":8273.8,"close":8286.33,"volume":13.747079,"trades":126,"volumePerTrade":0.10910380158730158,"indicators":{"ema":false,"sma":8283.62,"vol":33.83312324999999}},{"time":1526491740000,"open":8276.72,"high":8287.4,"low":8276.72,"close":8279.02,"volume":5.285887,"trades":172,"volumePerTrade":0.030731901162790697,"indicators":{"ema":false,"sma":8280.52,"vol":33.65530065}},{"time":1526491800000,"open":8279.02,"high":8327.5,"low":8279,"close":8315.33,"volume":141.525386,"trades":247,"volumePerTrade":0.5729772712550607,"indicators":{"ema":false,"sma":8283.958000000002,"vol":40.15512784999999}},{"time":1526491860000,"open":8315.33,"high":8327.39,"low":8293.31,"close":8295.3,"volume":91.820014,"trades":893,"volumePerTrade":0.10282196416573348,"indicators":{"ema":false,"sma":8286.373000000001,"vol":44.09651959999999}},{"time":1526491920000,"open":8295.3,"high":8302.99,"low":8260,"close":8277.36,"volume":156.060015,"trades":445,"volumePerTrade":0.3506966629213483,"indicators":{"ema":8270.998967741936,"sma":8286.459,"vol":51.234464149999994}},{"time":1526491980000,"open":8277.37,"high":8283.05,"low":8275,"close":8278.01,"volume":19.00987,"trades":77,"volumePerTrade":0.24688142857142856,"indicators":{"ema":8272.128731182795,"sma":8287.667,"vol":51.42973095}},{"time":1526492040000,"open":8280.39,"high":8281.43,"low":8277.23,"close":8277.23,"volume":5.294183,"trades":98,"volumePerTrade":0.05402227551020408,"indicators":{"ema":8273.179290322581,"sma":8288.007,"vol":51.5433762}},{"time":1526492100000,"open":8277.23,"high":8279.98,"low":8277.23,"close":8277.24,"volume":5.027069,"trades":85,"volumePerTrade":0.05914198823529412,"indicators":{"ema":8274.18488172043,"sma":8286.654,"vol":51.350158349999994}},{"time":1526492160000,"open":8277.24,"high":8286.26,"low":8277.24,"close":8281.75,"volume":16.134734,"trades":152,"volumePerTrade":0.1061495657894737,"indicators":{"ema":8275.403784946237,"sma":8285.807,"vol":51.67236584999999}},{"time":1526492220000,"open":8281.75,"high":8284.92,"low":8255.19,"close":8265,"volume":20.068084,"trades":200,"volumePerTrade":0.10034042,"indicators":{"ema":8275.452129032257,"sma":8283.257000000001,"vol":51.56599309999999}},{"time":1526492280000,"open":8260.98,"high":8280,"low":8255,"close":8255.34,"volume":15.018848,"trades":141,"volumePerTrade":0.1065166524822695,"indicators":{"ema":8274.821311827958,"sma":8280.158,"vol":51.94962449999999}},{"time":1526492340000,"open":8255.35,"high":8271.09,"low":8250.36,"close":8251.51,"volume":18.367479,"trades":194,"volumePerTrade":0.0946777268041237,"indicators":{"ema":8273.908258064517,"sma":8277.407,"vol":46.7461072}},{"time":1526492400000,"open":8251.51,"high":8260,"low":8237.03,"close":8259.17,"volume":21.617456,"trades":264,"volumePerTrade":0.08188430303030303,"indicators":{"ema":8273.462559139785,"sma":8271.791,"vol":39.299965449999995}},{"time":1526492460000,"open":8259.17,"high":8260,"low":8259.17,"close":8260,"volume":5.070953,"trades":62,"volumePerTrade":0.08178956451612904,"indicators":{"ema":8273.0291827957,"sma":8268.261,"vol":38.86564565}},{"time":1526492520000,"open":8260,"high":8269.99,"low":8259.18,"close":8261.82,"volume":7.548993,"trades":87,"volumePerTrade":0.08677003448275862,"indicators":{"ema":8272.668086021506,"sma":8266.707,"vol":34.012397699999994}},{"time":1526492580000,"open":8261.82,"high":8263.6,"low":8252.24,"close":8252.24,"volume":15.911614,"trades":101,"volumePerTrade":0.15754073267326732,"indicators":{"ema":8271.629548387096,"sma":8264.130000000001,"vol":30.235142549999996}},{"time":1526492640000,"open":8252.24,"high":8252.28,"low":8245.64,"close":8246.37,"volume":20.032161,"trades":658,"volumePerTrade":0.03044401367781155,"indicators":{"ema":8270.160688172044,"sma":8261.044,"vol":29.803294549999986}},{"time":1526492700000,"open":8246.37,"high":8277.23,"low":8245.64,"close":8272.6,"volume":18.469252,"trades":233,"volumePerTrade":0.07926717596566524,"indicators":{"ema":8270.35789247312,"sma":8260.58,"vol":30.35419944999999}},{"time":1526492760000,"open":8272.6,"high":8272.71,"low":8260.02,"close":8266,"volume":13.6452,"trades":230,"volumePerTrade":0.05932695652173913,"indicators":{"ema":8270.046731182794,"sma":8259.005000000001,"vol":30.736694849999992}},{"time":1526492820000,"open":8261.02,"high":8266.01,"low":8258.09,"close":8265.9,"volume":10.993535,"trades":196,"volumePerTrade":0.056089464285714284,"indicators":{"ema":8269.648860215053,"sma":8259.095,"vol":31.032390599999992}},{"time":1526492880000,"open":8266.01,"high":8280,"low":8264.03,"close":8280,"volume":17.520059,"trades":112,"volumePerTrade":0.15642909821428572,"indicators":{"ema":8270.073827956992,"sma":8261.560999999998,"vol":31.22103959999999}},{"time":1526492940000,"open":8275.49,"high":8281.04,"low":8268.82,"close":8269.28,"volume":7.784126,"trades":119,"volumePerTrade":0.06541282352941176,"indicators":{"ema":8269.697505376344,"sma":8263.338,"vol":31.345951549999988}},{"time":1526493000000,"open":8280.8,"high":8311.04,"low":8269.48,"close":8310.24,"volume":43.73642,"trades":272,"volumePerTrade":0.1607956617647059,"indicators":{"ema":8272.051376344085,"sma":8268.445,"vol":26.45650324999999}},{"time":1526493060000,"open":8310.24,"high":8325.4,"low":8290.98,"close":8290.98,"volume":59.961649,"trades":380,"volumePerTrade":0.15779381315789473,"indicators":{"ema":8273.099677419354,"sma":8271.543000000001,"vol":24.863584999999997}}]')
})
