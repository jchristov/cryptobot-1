const candles = require('./candles')
const { withIndicators } = require('../helpers')

test('withIndicators', () => {
  const candlesWithIndicators = withIndicators(candles, {
    ema: 30,
    sma: 10,
    vol: 20
  })

  expect(candlesWithIndicators).toEqual([
    { time: 1526423220000,
      open: '8493.99000000',
      high: '8493.99000000',
      low: '8486.01000000',
      close: '8492.97000000',
      volume: '8.18816600',
      trades: 365,
      volumePerTrade: 0.022433331506849317,
      indicators: { ema: false, sma: false, vol: false } },
    { time: 1526423280000,
      open: '8487.58000000',
      high: '8492.26000000',
      low: '8472.04000000',
      close: '8491.19000000',
      volume: '14.72210300',
      trades: 347,
      volumePerTrade: 0.0424268097982709,
      indicators: { ema: false, sma: false, vol: false } },
    { time: 1526423340000,
      open: '8491.19000000',
      high: '8491.19000000',
      low: '8483.55000000',
      close: '8488.00000000',
      volume: '18.00636100',
      trades: 187,
      volumePerTrade: 0.09629070053475935,
      indicators: { ema: false, sma: false, vol: false } },
    { time: 1526423400000,
      open: '8488.00000000',
      high: '8491.00000000',
      low: '8472.02000000',
      close: '8483.12000000',
      volume: '9.63508600',
      trades: 438,
      volumePerTrade: 0.021997913242009132,
      indicators: { ema: false, sma: false, vol: false } },
    { time: 1526423460000,
      open: '8483.08000000',
      high: '8491.00000000',
      low: '8472.70000000',
      close: '8480.48000000',
      volume: '8.29955700',
      trades: 320,
      volumePerTrade: 0.025936115625,
      indicators: { ema: false, sma: false, vol: false } },
    { time: 1526423520000,
      open: '8482.85000000',
      high: '8482.85000000',
      low: '8475.33000000',
      close: '8480.01000000',
      volume: '8.93428900',
      trades: 95,
      volumePerTrade: 0.09404514736842105,
      indicators: { ema: false, sma: false, vol: false } },
    { time: 1526423580000,
      open: '8480.01000000',
      high: '8482.85000000',
      low: '8471.80000000',
      close: '8482.24000000',
      volume: '2.97871700',
      trades: 138,
      volumePerTrade: 0.02158490579710145,
      indicators: { ema: false, sma: false, vol: false } },
    { time: 1526423640000,
      open: '8482.24000000',
      high: '8487.42000000',
      low: '8472.72000000',
      close: '8482.98000000',
      volume: '4.93512100',
      trades: 223,
      volumePerTrade: 0.022130587443946186,
      indicators: { ema: false, sma: false, vol: false } },
    { time: 1526423700000,
      open: '8482.98000000',
      high: '8487.42000000',
      low: '8477.84000000',
      close: '8477.84000000',
      volume: '7.28753900',
      trades: 98,
      volumePerTrade: 0.07436264285714285,
      indicators: { ema: false, sma: false, vol: false } },
    { time: 1526423760000,
      open: '8480.00000000',
      high: '8484.99000000',
      low: '8477.85000000',
      close: '8482.99000000',
      volume: '11.94923800',
      trades: 43,
      volumePerTrade: 0.27788925581395346,
      indicators: { ema: false, sma: 8484.181999999999, vol: false } },
    { time: 1526423820000,
      open: '8479.12000000',
      high: '8482.99000000',
      low: '8477.85000000',
      close: '8482.99000000',
      volume: '8.91656700',
      trades: 47,
      volumePerTrade: 0.18971419148936172,
      indicators: { ema: false, sma: 8483.184000000001, vol: false } },
    { time: 1526423880000,
      open: '8482.99000000',
      high: '8483.00000000',
      low: '8478.58000000',
      close: '8482.00000000',
      volume: '2.29759700',
      trades: 63,
      volumePerTrade: 0.036469793650793655,
      indicators: { ema: false, sma: 8482.265000000001, vol: false } },
    { time: 1526423940000,
      open: '8479.17000000',
      high: '8484.99000000',
      low: '8479.17000000',
      close: '8481.00000000',
      volume: '4.67766000',
      trades: 78,
      volumePerTrade: 0.05997,
      indicators: { ema: false, sma: 8481.564999999999, vol: false } },
    { time: 1526424000000,
      open: '8484.96000000',
      high: '8484.96000000',
      low: '8480.00000000',
      close: '8483.00000000',
      volume: '3.54944800',
      trades: 96,
      volumePerTrade: 0.03697341666666667,
      indicators: { ema: false, sma: 8481.552999999998, vol: false } },
    { time: 1526424060000,
      open: '8482.99000000',
      high: '8484.68000000',
      low: '8477.00000000',
      close: '8481.00000000',
      volume: '19.05005100',
      trades: 239,
      volumePerTrade: 0.07970732635983263,
      indicators: { ema: false, sma: 8481.605, vol: false } },
    { time: 1526424120000,
      open: '8481.00000000',
      high: '8481.00000000',
      low: '8466.34000000',
      close: '8468.00000000',
      volume: '12.80614700',
      trades: 912,
      volumePerTrade: 0.014041827850877191,
      indicators: { ema: false, sma: 8480.404, vol: false } },
    { time: 1526424180000,
      open: '8466.34000000',
      high: '8478.32000000',
      low: '8451.00000000',
      close: '8451.10000000',
      volume: '52.78570000',
      trades: 999,
      volumePerTrade: 0.05283853853853854,
      indicators: { ema: false, sma: 8477.289999999999, vol: false } },
    { time: 1526424240000,
      open: '8451.10000000',
      high: '8468.77000000',
      low: '8451.00000000',
      close: '8457.51000000',
      volume: '11.42304300',
      trades: 462,
      volumePerTrade: 0.0247252012987013,
      indicators: { ema: false, sma: 8474.743, vol: false } },
    { time: 1526424300000,
      open: '8457.51000000',
      high: '8463.79000000',
      low: '8448.02000000',
      close: '8457.57000000',
      volume: '47.61308900',
      trades: 615,
      volumePerTrade: 0.07741965691056911,
      indicators: { ema: false, sma: 8472.716, vol: false } },
    { time: 1526424360000,
      open: '8448.03000000',
      high: '8457.86000000',
      low: '8431.30000000',
      close: '8440.98000000',
      volume: '25.64275600',
      trades: 1259,
      volumePerTrade: 0.0203675583796664,
      indicators: { ema: false, sma: 8468.514999999998, vol: 14.184911750000001 } },
    { time: 1526424420000,
      open: '8440.96000000',
      high: '8440.97000000',
      low: '8401.30000000',
      close: '8418.99000000',
      volume: '126.88516000',
      trades: 1667,
      volumePerTrade: 0.07611587282543492,
      indicators: { ema: false, sma: 8462.115, vol: 20.11976145 } },
    { time: 1526424480000,
      open: '8418.99000000',
      high: '8452.81000000',
      low: '8409.30000000',
      close: '8443.70000000',
      volume: '52.77796700',
      trades: 725,
      volumePerTrade: 0.07279719586206897,
      indicators: { ema: false, sma: 8458.285, vol: 22.022554649999996 } },
    { time: 1526424540000,
      open: '8448.36000000',
      high: '8448.36000000',
      low: '8412.82000000',
      close: '8437.38000000',
      volume: '21.86838300',
      trades: 384,
      volumePerTrade: 0.0569489140625,
      indicators: { ema: false, sma: 8453.923, vol: 22.21565575 } },
    { time: 1526424600000,
      open: '8437.38000000',
      high: '8450.00000000',
      low: '8421.95000000',
      close: '8430.02000000',
      volume: '16.94309500',
      trades: 468,
      volumePerTrade: 0.03620319444444444,
      indicators: { ema: false, sma: 8448.625000000002, vol: 22.5810562 } },
    { time: 1526424660000,
      open: '8422.30000000',
      high: '8437.26000000',
      low: '8421.77000000',
      close: '8425.39000000',
      volume: '11.32992600',
      trades: 197,
      volumePerTrade: 0.05751231472081218,
      indicators: { ema: false, sma: 8443.064000000002, vol: 22.732574649999997 } },
    { time: 1526424720000,
      open: '8429.96000000',
      high: '8430.00000000',
      low: '8405.09000000',
      close: '8418.47000000',
      volume: '32.82431600',
      trades: 533,
      volumePerTrade: 0.061584082551594754,
      indicators: { ema: false, sma: 8438.111, vol: 23.927076000000003 } },
    { time: 1526424780000,
      open: '8418.47000000',
      high: '8445.36000000',
      low: '8409.00000000',
      close: '8443.63000000',
      volume: '58.43096600',
      trades: 597,
      volumePerTrade: 0.0978743149078727,
      indicators: { ema: false, sma: 8437.364, vol: 26.699688449999996 } },
    { time: 1526424840000,
      open: '8442.78000000',
      high: '8445.35000000',
      low: '8430.23000000',
      close: '8437.03000000',
      volume: '9.34266900',
      trades: 252,
      volumePerTrade: 0.037074083333333334,
      indicators: { ema: false, sma: 8435.316, vol: 26.920065849999997 } },
    { time: 1526424900000,
      open: '8437.03000000',
      high: '8444.00000000',
      low: '8434.27000000',
      close: '8434.50000000',
      volume: '14.55955500',
      trades: 245,
      volumePerTrade: 0.05942675510204082,
      indicators: { ema: false, sma: 8433.009000000002, vol: 27.283666649999997 } },
    { time: 1526424960000,
      open: '8440.00000000',
      high: '8443.99000000',
      low: '8412.93000000',
      close: '8428.98000000',
      volume: '23.46065800',
      trades: 497,
      volumePerTrade: 0.04720454325955734,
      indicators: { ema: 8449.239999999998, sma: 8431.809, vol: 27.85923765 } },
    { time: 1526425020000,
      open: '8430.00000000',
      high: '8443.00000000',
      low: '8422.33000000',
      close: '8434.84000000',
      volume: '13.39889300',
      trades: 186,
      volumePerTrade: 0.07203705913978495,
      indicators: { ema: 8447.51987096774, sma: 8433.393999999998, vol: 28.083353950000003 } },
    { time: 1526425080000,
      open: '8435.18000000',
      high: '8443.00000000',
      low: '8429.05000000',
      close: '8438.00000000',
      volume: '29.70574000',
      trades: 265,
      volumePerTrade: 0.11209713207547169,
      indicators: { ema: 8446.128623655914, sma: 8432.823999999999, vol: 29.453761099999998 } },
    { time: 1526425140000,
      open: '8436.28000000',
      high: '8460.00000000',
      low: '8429.04000000',
      close: '8451.95000000',
      volume: '57.84212900',
      trades: 508,
      volumePerTrade: 0.11386245866141732,
      indicators: { ema: 8445.751763440861, sma: 8434.280999999999, vol: 32.11198455 } },
    { time: 1526425200000,
      open: '8451.96000000',
      high: '8461.00000000',
      low: '8446.79000000',
      close: '8446.79000000',
      volume: '17.05955700',
      trades: 530,
      volumePerTrade: 0.03218784339622642,
      indicators: { ema: 8445.119526881721, sma: 8435.957999999999, vol: 32.787490000000005 } },
    { time: 1526425260000,
      open: '8446.79000000',
      high: '8446.80000000',
      low: '8436.29000000',
      close: '8436.43000000',
      volume: '19.72442100',
      trades: 585,
      volumePerTrade: 0.033716958974358974,
      indicators: { ema: 8443.897032258064, sma: 8437.062, vol: 32.8212085 } },
    { time: 1526425320000,
      open: '8443.41000000',
      high: '8460.30000000',
      low: '8436.41000000',
      close: '8450.09000000',
      volume: '17.05172600',
      trades: 329,
      volumePerTrade: 0.051828954407294826,
      indicators: { ema: 8443.650559139785, sma: 8440.223999999998, vol: 33.03348745 } },
    { time: 1526425380000,
      open: '8457.41000000',
      high: '8468.18000000',
      low: '8445.74000000',
      close: '8468.18000000',
      volume: '11.18962100',
      trades: 141,
      volumePerTrade: 0.07935901418439717,
      indicators: { ema: 8444.63552688172, sma: 8442.679, vol: 30.953683500000004 } },
    { time: 1526425440000,
      open: '8468.19000000',
      high: '8484.00000000',
      low: '8459.59000000',
      close: '8465.41000000',
      volume: '30.35924000',
      trades: 236,
      volumePerTrade: 0.1286408474576271,
      indicators: { ema: 8445.472021505377, sma: 8445.517000000002, vol: 31.900493350000005 } },
    { time: 1526425500000,
      open: '8465.42000000',
      high: '8474.39000000',
      low: '8453.19000000',
      close: '8461.29000000',
      volume: '10.51896400',
      trades: 706,
      volumePerTrade: 0.014899382436260624,
      indicators: { ema: 8446.080494623657, sma: 8448.196000000002, vol: 30.045787100000002 } },
    { time: 1526425560000,
      open: '8461.29000000',
      high: '8468.80000000',
      low: '8461.29000000',
      close: '8468.79000000',
      volume: '5.98949000',
      trades: 642,
      volumePerTrade: 0.009329423676012461,
      indicators: { ema: 8447.208430107527, sma: 8452.177000000001, vol: 29.0631238 } },
    { time: 1526425620000,
      open: '8466.00000000',
      high: '8466.00000000',
      low: '8461.30000000',
      close: '8462.50000000',
      volume: '9.67549600',
      trades: 215,
      volumePerTrade: 0.04500230697674419,
      indicators: { ema: 8447.961096774194, sma: 8454.943, vol: 23.202640599999995 } },
    { time: 1526425680000,
      open: '8462.50000000',
      high: '8464.89000000',
      low: '8451.39000000',
      close: '8451.39000000',
      volume: '8.89161200',
      trades: 174,
      volumePerTrade: 0.0511012183908046,
      indicators: { ema: 8448.041053763442, sma: 8456.282000000001, vol: 21.008322849999995 } },
    { time: 1526425740000,
      open: '8451.52000000',
      high: '8460.75000000',
      low: '8439.67000000',
      close: '8449.04000000',
      volume: '10.20999700',
      trades: 712,
      volumePerTrade: 0.014339883426966292,
      indicators: { ema: 8448.035225806452, sma: 8455.991, vol: 20.425403549999995 } },
    { time: 1526425800000,
      open: '8449.04000000',
      high: '8464.85000000',
      low: '8439.80000000',
      close: '8460.75000000',
      volume: '8.64074400',
      trades: 186,
      volumePerTrade: 0.04645561290322581,
      indicators: { ema: 8448.853612903225, sma: 8457.386999999999, vol: 20.010285999999997 } },
    { time: 1526425860000,
      open: '8460.75000000',
      high: '8460.75000000',
      low: '8453.00000000',
      close: '8453.03000000',
      volume: '9.95078900',
      trades: 163,
      volumePerTrade: 0.06104778527607362,
      indicators: { ema: 8449.221784946238, sma: 8459.047, vol: 19.941329149999994 } },
    { time: 1526425920000,
      open: '8453.00000000',
      high: '8453.03000000',
      low: '8450.06000000',
      close: '8453.03000000',
      volume: '15.53174100',
      trades: 102,
      volumePerTrade: 0.1522719705882353,
      indicators: { ema: 8449.65010752688, sma: 8459.341, vol: 19.0767004 } },
    { time: 1526425980000,
      open: '8452.00000000',
      high: '8472.87000000',
      low: '8451.77000000',
      close: '8472.58000000',
      volume: '30.23519500',
      trades: 187,
      volumePerTrade: 0.1616855347593583,
      indicators: { ema: 8451.371913978493, sma: 8459.781, vol: 17.666911849999998 } },
    { time: 1526426040000,
      open: '8472.58000000',
      high: '8472.87000000',
      low: '8454.35000000',
      close: '8456.85000000',
      volume: '6.16174100',
      trades: 213,
      volumePerTrade: 0.028928361502347417,
      indicators: { ema: 8452.032688172043, sma: 8458.925000000001, vol: 17.507865449999997 } },
    { time: 1526426100000,
      open: '8456.85000000',
      high: '8468.68000000',
      low: '8450.28000000',
      close: '8460.01000000',
      volume: '6.95163000',
      trades: 161,
      volumePerTrade: 0.04317782608695652,
      indicators: { ema: 8452.89875268817, sma: 8458.797, vol: 17.1274692 } },
    { time: 1526426160000,
      open: '8460.01000000',
      high: '8470.00000000',
      low: '8459.38000000',
      close: '8468.01000000',
      volume: '3.52946200',
      trades: 249,
      volumePerTrade: 0.014174546184738956,
      indicators: { ema: 8454.275698924732, sma: 8458.719, vol: 16.1309094 } }
  ])
})
